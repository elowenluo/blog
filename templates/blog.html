{% extends "base.html" %}

{% block content %}
<article class="blog">
  <header class="blog__header">
    <h1>{{ section.title }}</h1>
    {% if section.description %}
      <p class="blog__description">{{ section.description }}</p>
    {% endif %}
  </header>

  <div class="blog__layout">
    <section class="blog__posts">
      {% if paginator.pages %}
        <ul class="blog__list">
          {% for page in paginator.pages %}
            <li class="blog__item">
              <article class="post">
                <header class="post__header">
                  <h2 class="post__title"><a href="{{ page.permalink }}">{{ page.title }}</a></h2>
                  {% if page.date %}
                    <time class="post__date" datetime="{{ page.date }}">{{ page.date | date(format="%B %d, %Y") }}</time>
                  {% endif %}
                </header>
                {% if page.description %}
                  <div class="post__summary">{{ page.description }}</div>
                {% endif %}
              </article>
            </li>
          {% endfor %}
        </ul>

        {% if paginator.number_pagers > 1 %}
          <nav class="pagination" aria-label="Pagination">
            <ul class="pagination__list">
              {% if paginator.previous %}
                <li class="pagination__item pagination__item--prev">
                  <a href="{{ paginator.previous }}" aria-label="Previous page">← Previous</a>
                </li>
              {% else %}
                <li class="pagination__item pagination__item--prev pagination__item--disabled">
                  <span>← Previous</span>
                </li>
              {% endif %}
              
              <!-- 保留原有分页逻辑代码 -->
              
              {% if paginator.next %}
                <li class="pagination__item pagination__item--next">
                  <a href="{{ paginator.next }}" aria-label="Next page">Next →</a>
                </li>
              {% else %}
                <li class="pagination__item pagination__item--next pagination__item--disabled">
                  <span>Next →</span>
                </li>
              {% endif %}
            </ul>
          </nav>
        {% endif %}
      {% else %}
        <p class="blog__empty">No posts available</p>
      {% endif %}
    </section>

    <aside class="sidebar">
      {% if section.taxonomies %}
        <section class="sidebar__section sidebar__section--categories">
          <h2>Categories</h2>
          {% if section.taxonomies.categories %}
            <ul class="sidebar__list">
              {% for category, pages in section.taxonomies.categories | sort(attribute="1", reverse=true) %}
                <li class="sidebar__item">
                  <a href="{{ get_taxonomy_url(kind="categories", name=category) }}">
                    {{ category }} <span class="sidebar__count">({{ pages | length }})</span>
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No categories available</p>
          {% endif %}
        </section>

        <section class="sidebar__section sidebar__section--tags">
          <h2>Tags</h2>
          {% if section.taxonomies.tags %}
            <ul class="sidebar__list sidebar__list--tags">
              {% for tag, pages in section.taxonomies.tags | sort(attribute="1", reverse=true) %}
                <li class="sidebar__item">
                  <a href="{{ get_taxonomy_url(kind="tags", name=tag) }}" 
                    class="tag tag--{% if pages | length > 10 %}popular{% elif pages | length > 5 %}medium{% else %}small{% endif %}">
                    {{ tag }} <span class="sidebar__count">({{ pages | length }})</span>
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No tags available</p>
          {% endif %}
        </section>
      {% endif %}
    </aside>
  </div>
</article>
{% endblock content %}